<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/WEB-INF/include/admin/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{maximusBundle.AppName}"></h:outputText>
        </ui:define>
        <ui:define name="menu">
            <!-- Menu here. Also a layout and a way to log a user out -->
            <ui:include src="/sales/appmenu.xhtml"/>
        </ui:define>
        <ui:define name="body">
            <h:form>
                <p:panel header="#{maximusBundle.new_request_label}" id="panelRequest">
                    <p:messages />
                    <h:panelGrid columns="2" style="text-align: left">
                        <h:panelGrid columns="2" style="text-align: left">
                            <h:outputText value="#{maximusBundle.CustomerHeading} *" />
                            <h:selectOneMenu id="customer" value="#{createQuoteController.customerSelected}" converter="customerConverter" style="width:178px;">
                                <f:selectItem itemLabel="#{maximusBundle.SelectOneMessage}"/>
                                <f:selectItems value="#{createQuoteController.customerList}"
                                               var="item"
                                               itemValue="#{item}"
                                               itemLabel="#{item.companyName.companyName}"
                                               />
                                <p:ajax update="panelRequest" /> 
                            </h:selectOneMenu>

                        </h:panelGrid>
                        <h:panelGrid style="text-align: left">
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="text-align: left" rendered="#{createQuoteController.customerSelected != null}">
                            <h:outputText value="#{maximusBundle.label_address}" />
                            <p:inputText value="#{createQuoteController.customerSelected.companyName.companyAddress}" disabled="true" style="margin-left: 15px;"/>



                            <h:outputText value="#{maximusBundle.label_country}" />
                            <p:inputText value="#{createQuoteController.customerSelected.companyName.country}" disabled="true" style="margin-left: 15px;" />



                            <h:outputText value="#{maximusBundle.label_contact}" />
                            <p:inputText value="#{createQuoteController.customerSelected.primaryContact}" style="margin-left: 15px;"/>

                            <h:outputText value="#{maximusBundle.label_email}" />
                            <p:inputText value="#{createQuoteController.customerSelected.primaryEmail}" style="margin-left: 15px;" />

                        </h:panelGrid>
                        <h:panelGrid columns="2" style="text-align: left; vertical-align: top;" rendered="#{createQuoteController.customerSelected != null}">
                            <h:outputText value="#{maximusBundle.label_shipping_to}"  style="margin-left: 10px; vertical-align: top;" />
                            <p:inputTextarea value="#{createQuoteController.shippingTo}"  style="width:300px; margin-left: 10px; "/>
                            <h:outputText value="#{maximusBundle.label_include_shipping}"  style="margin-left: 10px;"  />
                            <h:selectOneMenu id="cost" value="#{createQuoteController.includeShipping}"  style="width:308px; margin-left: 10px;">
                                <f:selectItem itemLabel="#{maximusBundle.No}" itemValue="No"/>
                                <f:selectItem itemLabel="#{maximusBundle.Yes_price_item}" itemValue="#{maximusBundle.Yes_price_item}"/>
                                <f:selectItem itemLabel="#{maximusBundle.Yes_separate}" itemValue="#{maximusBundle.Yes_separate}"/>
                                <p:ajax update="datalistProduct" /> 
                            </h:selectOneMenu>

                        </h:panelGrid>
                    </h:panelGrid>
                    <p:spacer />
                    <p:separator />
                    <p:outputPanel style="text-align: right; width: 100% ">
                        <p:commandButton  type="button" id="buttonAddPart" value="#{maximusBundle.add_part_button}" onclick="PF('dialogPart').show()" ajax="true" />
                    </p:outputPanel>
                    <p:spacer />
                    <p:dataTable id="datalistProduct"
                                 value="#{createQuoteController.partListHas}"
                                 lazy="true"
                                 var="item"
                                 emptyMessage="list Empty"
                                 rendered="#{createQuoteController.partListHas != null}"
                                 >

                        <p:column  style="width : 110px">
                            <f:facet name="header">
                                <h:outputText value="#{maximusBundle.CreateProductCostTitle_partNumber}"/>
                            </f:facet>
                            <h:outputText value="#{item.product.partNumber}">
                                <f:convertDateTime pattern="MM/dd/yyyy" />
                            </h:outputText>
                        </p:column>

                        <p:column  style="width : 160px">
                            <f:facet name="header">
                                <h:outputText value="#{maximusBundle.CreateProductTitle_description}"/>
                            </f:facet>
                            <h:outputText value="#{item.product.description}"/>
                        </p:column>

                        <p:column style="width : 90px">
                            <f:facet name="header">
                                <h:outputText value="#{maximusBundle.condition_label}"/>
                            </f:facet>
                            <p:selectOneButton value="#{item.condition}" required="true" requiredMessage="#{maximusBundle.message_condition_select}">
                                <f:selectItem itemLabel="#{maximusBundle.used}" itemValue="#{maximusBundle.used}"  />
                                <f:selectItem itemLabel="#{maximusBundle.new}" itemValue="#{maximusBundle.new}" />
                            </p:selectOneButton>
                        </p:column>

                        <p:column  style="width : 80px">
                            <f:facet name="header">
                                <h:outputText value="#{maximusBundle.qty_label}"/>
                            </f:facet>
                            <p:spinner id="basic" value="#{item.qtyRequested}" size="5"  min="0" required="true" requiredMessage="#{maximusBundle.message_qty_product}"/>
                        </p:column>

                        <p:column  style="width : 90px">
                            <f:facet name="header">
                                <h:outputText value="#{maximusBundle.target_price_label}"/>
                            </f:facet>
                            <p:inputMask converter="javax.faces.Double" converterMessage="Error" mask="9?9999999999999999" value="#{item.product.price}" required="true" requiredMessage="#{maximusBundle.message_price_product}" size="10">


                            </p:inputMask>
                        </p:column>

                        <!--                        <p:column style="width : 90px">
                                                    <f:facet name="header">
                                                        <h:outputText value="Extended"/>
                                                    </f:facet>
                                                    <h:outputText value=""/>
                                                </p:column>-->

                        <p:column style="width : 80px" rendered="#{createQuoteController.includeShipping == maximusBundle.Yes_price_item}">
                            <f:facet name="header">
                                <h:outputText value="#{maximusBundle.shipping_cost_label}"/>
                            </f:facet>
                            <h:outputText value="#{item.product.price}">
                                <f:convertNumber pattern="Â¤#,##0.00" currencySymbol="$" />
                            </h:outputText>
                        </p:column>

                        <p:columnGroup type="footer" rendered="#{createQuoteController.includeShipping == maximusBundle.Yes_separate}">
                            <p:row>
                                <p:column colspan="5" footerText="#{maximusBundle.shipping_cost_label} $" style="text-align:right"/>
                                <p:column footerText="#{createQuoteController.totalPriceCot}" />
                            </p:row>
                        </p:columnGroup>
                    </p:dataTable>
                    <p:spacer />
                    <p:separator />
                    <p:spacer />
                    <h:panelGrid width="100%" style="text-align: left;">
                        <h:outputText value="#{maximusBundle.note_label}"  />
                        <p:inputTextarea value="#{createQuoteController.note}"   style="width:70%; margin-left: 10px;"/>
                    </h:panelGrid>

                </p:panel>
                <p:commandButton value="#{maximusBundle.Cancel}" action="index" id="buttonCancel" ajax="false" />
                <p:commandButton value="#{maximusBundle.Save}" action="#{createQuoteController.createNewRequest}" id="buttonSave" ajax="false"/>

                <p:dialog header="Basic Dialog"  widgetVar="dialogPart"  id="dialogPart" resizable="false" draggable="true"  maximizable="true" modal="true" position="center" >
                    <h:form>
                        <h:panelGroup  id="panelPrincipal">
                            <p:panel header="Search Part" id="panelSearch">
                                <p:messages />
                                <h:panelGrid columns="2" style="text-align: left"> 

                                    <h:outputText value="#{maximusBundle.CreateHasTitle_hasPK_partNumber}" />
                                    <p:inputText value="#{createQuoteController.nroPart}"  />

                                    <h:outputText value="#{maximusBundle.CreateProductTitle_manufacture}" />
                                    <p:inputText value="#{createQuoteController.manufacturePart}"  />

                                    <h:outputText value="#{maximusBundle.CreateProductTitle_description}" />
                                    <p:inputText value="#{createQuoteController.descriptionPart}" />


                                    <h:outputText value="#{maximusBundle.CreateProductTitle_type}" />
                                    <p:inputText value="#{createQuoteController.typePart}"  />


                                </h:panelGrid>

                            </p:panel>
                            <p:outputPanel style="text-align: left; width: 100%">
                                <p:commandButton value="#{maximusBundle.search}" actionListener="#{createQuoteController.searchPart()}" ajax="true" update="panelPrincipal" immediate="true"/>

                                <p:commandButton value="Reset" actionListener="#{createQuoteController.reset()}" ajax="true" update="panelPrincipal" immediate="true" />

                            </p:outputPanel> 



                            <h:panelGroup  rendered="#{createQuoteController.partList != null}" id="panelTable">
                                <p:separator/>
                                <p:dataTable id="datalistPart"
                                             value="#{createQuoteController.partList}"
                                             lazy="true"
                                             var="item"
                                             paginator="true"
                                             rows="10"
                                             rowsPerPageTemplate="10,20,30,40,50"
                                             emptyMessage="list Empty"
                                             paginatorPosition="bottom"
                                             selection="#{createQuoteController.selectedPart}"
                                             rowKey="#{item.partNumber}"
                                             scrollable="true"
                                             scrollHeight="300"
                                             >
                                    <p:column selectionMode="multiple" style="width:10px;text-align:center"/>
                                    <p:column  style="width :90px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateHasTitle_hasPK_partNumber}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.partNumber}"/>

                                    </p:column>

                                    <p:column  style="width : 90px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateProductTitle_manufacture}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.manufacture}"/>
                                    </p:column>

                                    <p:column style="width : 140px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateProductTitle_description}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.description}"/>
                                    </p:column>

                                    <p:column  style="width : 85px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateProductTitle_type}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.type}"/>
                                    </p:column>

                                    <p:column  style="width : 140px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateProductTitle_notes}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.notes}"/>
                                    </p:column>

                                    <p:column style="width : 85px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateProductTitle_retailPrice}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.retailPrice}">
                                            <f:convertNumber pattern="Â¤#,##0.00" currencySymbol="$" />
                                        </h:outputText>
                                    </p:column>

                                    <p:column style="width : 120px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateProductTitle_wholesalePrice}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.wholesalePrice}">  
                                            <f:convertNumber pattern="Â¤#,##0.00" currencySymbol="R$" />
                                        </h:outputText>
                                    </p:column>

                                    <p:column style="width : 80px">
                                        <f:facet name="header">
                                            <h:outputText value="#{maximusBundle.CreateProductTitle_price}"/>
                                        </f:facet>
                                        <h:outputText value="#{item.price}">
                                            <f:convertNumber pattern="Â¤#,##0.00" currencySymbol="R$" />
                                        </h:outputText>
                                    </p:column>

                                </p:dataTable>

                                <p:separator/>

                                <p:outputPanel style="text-align: left; width: 100%">

                                    <p:commandButton value="#{maximusBundle.Cancel}"  ajax="false" oncomplete="PF('dialogPart').hide()" update="datalistProduct"/>
                                    <p:commandButton value="#{maximusBundle.add}" id="buttonAdd" ajax="false"  action="#{createQuoteController.addPart()}" oncomplete="PF('dialogPart').hide()" update="datalistProduct"/>
                                </p:outputPanel> 

                            </h:panelGroup>
                        </h:panelGroup>
                    </h:form>
                </p:dialog>

            </h:form> 
        </ui:define>

    </ui:composition>

</html>
