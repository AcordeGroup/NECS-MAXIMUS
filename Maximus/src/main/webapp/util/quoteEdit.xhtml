<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/WEB-INF/include/admin/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{maximusBundle.AppName}"></h:outputText>
        </ui:define>
        <ui:define name="menu">
            <!-- Menu here. Also a layout and a way to log a user out -->
            <ui:include src="/sales/appmenu.xhtml"/>
        </ui:define>
        <ui:define name="body">
            <h:form id="form">
                <p:panel header="#{maximusBundle.new_request_label}" id="panelRequest">
                    <p:messages />
                    <h:panelGrid columns="2" style="text-align: left">
                        <h:outputText value="#{maximusBundle.CustomerHeading} *" />
                        <h:selectOneMenu id="customer" value="#{editQuoteController.quote.idCustomer}" converter="customerConverter" style="width:178px;">
                            <f:selectItem itemLabel="#{maximusBundle.SelectOneMessage}"/>
                            <f:selectItems value="#{editQuoteController.customerList}"
                                           var="item"
                                           itemValue="#{item}"
                                           itemLabel="#{item.companyName.companyName}"
                                           />
                            <p:ajax update="panelRequest" /> 
                        </h:selectOneMenu>

                    </h:panelGrid>
                    <p:outputPanel   rendered="#{editQuoteController.quote.idCustomer != null}">
                        <h:panelGrid columns="2" style="text-align: left">

                            <h:panelGrid columns="2" style="text-align: left">
                                <h:outputText value="#{maximusBundle.label_address}" />
                                <p:inputText value="#{editQuoteController.quote.idCustomer.companyName.companyAddress}" disabled="true" style="margin-left: 15px;"/>



                                <h:outputText value="#{maximusBundle.label_country}" />
                                <p:inputText value="#{editQuoteController.quote.idCustomer.companyName.country}" disabled="true" style="margin-left: 15px;" />



                                <h:outputText value="#{maximusBundle.label_contact}" />
                                <p:inputText value="#{editQuoteController.quote.contact}" style="margin-left: 15px;"/>

                                <h:outputText value="#{maximusBundle.label_email}" />
                                <p:inputText value="#{editQuoteController.quote.email}" style="margin-left: 15px;" />

                            </h:panelGrid>
                            <h:panelGrid columns="2" style="text-align: left; vertical-align: top;" rendered="#{editQuoteController.quote.idCustomer != null}">
                                <h:outputText value="#{maximusBundle.label_shipping_to}"  style="margin-left: 10px; vertical-align: top;" />
                                <p:inputTextarea value="#{editQuoteController.quote.shipping_to}"  style="width:300px; margin-left: 10px; "/>
                                <h:outputText value="#{maximusBundle.label_include_shipping}"  style="margin-left: 10px;"  />
                                <h:selectOneMenu id="cost" value="#{editQuoteController.includeShipping}"  style="width:308px; margin-left: 10px;">
                                    <f:selectItem itemLabel="#{maximusBundle.No}" itemValue="No"/>
                                    <f:selectItem itemLabel="#{maximusBundle.Yes_price_item}" itemValue="#{maximusBundle.Yes_price_item}"/>
                                    <f:selectItem itemLabel="#{maximusBundle.Yes_separate}" itemValue="#{maximusBundle.Yes_separate}"/>
                                    <p:ajax update="datalistProduct" /> 
                                </h:selectOneMenu>

                            </h:panelGrid>
                        </h:panelGrid>
                        <p:spacer />
                        <p:separator />
                        <p:outputPanel style="text-align: right; width: 100% ">
                            <p:commandButton  type="button" id="buttonAddPart" value="#{maximusBundle.add_part_button}" onclick="PF('dialogPart').show()" ajax="true" />
                        </p:outputPanel>
                        <p:spacer />
                        <p:dataTable id="datalistProduct"
                                     value="#{editQuoteController.partListHas}"
                                     var="item"
                                     emptyMessage="list Empty"
                                     rendered="#{editQuoteController.partListHas != null}"
                                     >

                            <p:column  style="width : 110px">
                                <f:facet name="header">
                                    <h:outputText value="#{maximusBundle.CreateProductCostTitle_partNumber}"/>
                                </f:facet>
                                <h:outputText value="#{item.product.partNumber}">
                                    <f:convertDateTime pattern="MM/dd/yyyy" />
                                </h:outputText>
                            </p:column>

                            <p:column  style="width : 160px">
                                <f:facet name="header">
                                    <h:outputText value="#{maximusBundle.CreateProductTitle_description}"/>
                                </f:facet>
                                <h:outputText value="#{item.product.description}"/>
                            </p:column>

                            <p:column style="width : 90px">
                                <f:facet name="header">
                                    <h:outputText value="#{maximusBundle.condition_label}"/>
                                </f:facet>
                                <p:selectOneButton value="#{item.condition}" required="true" requiredMessage="#{maximusBundle.message_condition_select}">
                                    <f:selectItem itemLabel="#{maximusBundle.used}" itemValue="#{maximusBundle.used}"  />
                                    <f:selectItem itemLabel="#{maximusBundle.new}" itemValue="#{maximusBundle.new}" />
                                </p:selectOneButton>
                            </p:column>

                            <p:column  style="width : 80px">
                                <f:facet name="header">
                                    <h:outputText value="#{maximusBundle.qty_label}"/>
                                </f:facet>
                                <p:spinner id="basic" value="#{item.qtyRequested}" size="5"  min="0" required="true" requiredMessage="#{maximusBundle.message_qty_product}"/>
                            </p:column>

                            <p:column  style="width : 90px">
                                <f:facet name="header">
                                    <h:outputText value="#{maximusBundle.target_price_label}"/>
                                </f:facet>
                                <p:inputMask converter="javax.faces.Double" converterMessage="Error" mask="9?9999999999999999" value="#{item.product.price}" required="true" requiredMessage="#{maximusBundle.message_price_product}" size="10"/>

                            </p:column>

                            <p:column style="width : 90px">
                                <f:facet name="header">
                                    <h:outputText value="Extended"/>
                                </f:facet>
                                <p:inputMask converter="javax.faces.Double" converterMessage="Error" mask="9?9999999999999999" value="#{item.suggestedSalesPrice}" required="true" requiredMessage="#{maximusBundle.message_price_product}" size="10"/>
                            </p:column>

                            <p:column style="width : 80px" rendered="#{editQuoteController.includeShipping == maximusBundle.Yes_price_item}">
                                <f:facet name="header">
                                    <h:outputText value="#{maximusBundle.shipping_cost_label}"/>
                                </f:facet>
                                <p:inputMask converter="javax.faces.Double" converterMessage="Error" mask="9?9999999999999999" value="#{item.shipping_cost}" required="true" requiredMessage="#{maximusBundle.message_shipping_cost_for_product}" size="10"/>

                            </p:column>

                            <p:columnGroup type="footer" rendered="#{editQuoteController.includeShipping== maximusBundle.Yes_separate}">
                                <p:row>
                                    <p:column colspan="6" footerText="#{maximusBundle.shipping_cost_label} $" style="text-align:right"/>
                                    <p:column footerText="#{editQuoteController.quote.shipping_cost}" >
                                        <f:facet name="footer">
                                            <p:inputMask converter="javax.faces.Double" converterMessage="Error" mask="9?9999999999999999" value="#{editQuoteController.quote.shipping_cost}" required="true" requiredMessage="#{maximusBundle.message_shipping_cost}" size="10"/>
                                        </f:facet>
                                    </p:column>
                                </p:row>
                            </p:columnGroup>
                              <p:column style="width : 80px">
                                <f:facet name="header">
                                    <h:outputText value="action"/>
                                </f:facet>
                                  <p:commandLink id="buttonRemovePart" value="#{maximusBundle.remove_button}" actionListener="#{editQuoteController.removePart(item)}" ajax="true" update=":form:datalistProduct" process="@this" />

                            </p:column>
                        </p:dataTable>
                        <p:spacer />
                        <p:separator />
                        <p:spacer />
                        <h:panelGrid width="100%" style="text-align: left;">
                            <h:outputText value="#{maximusBundle.ViewProductTitle_notes}"  />
                            <p:dataList
                                value="#{editQuoteController.quoteListNote}" 
                                var="nota" 
                                type="definition"
                                rendered="#{editQuoteController.quoteListNote.size() > 0}"
                                >

                                <p:panelGrid  style="margin: 15px 15px 15px 15px; width: 90%; border: none !important;"  >

                                    <p:row>
                                        <p:column style="width: 3%;" rowspan="3">

                                        </p:column>
                                        <p:column style="width: 25%;">
                                            <div style="position: relative; top: -10px; vertical-align: middle; ">
                                                <div style="position: absolute;"> <h:outputText  value="#{nota.idQuote.idAgent.name}, #{nota.idQuote.idAgent.lastName}" /> </div>
                                                <h:panelGroup rendered="#{nota.idQuote.idAgent.type == 'Sales'}">   
                                                    <div  style="background-color: #039BE5; color: white; position: absolute; left: 130px; padding: 0; top: 0; width: 100px; text-align: center; border-radius: 15px;">
                                                        <h:outputText  value="#{nota.idQuote.idAgent.type}"  />

                                                    </div>
                                                </h:panelGroup>
                                                <h:panelGroup rendered="#{nota.idQuote.idAgent.type == 'Purchasing'}" > 
                                                    <div  style="background-color: #FF2020; color: white; position: absolute; left: 130px; padding: 0; top: 0; width: 100px; text-align: center; border-radius: 15px;">

                                                        <h:outputText  value="#{nota.idQuote.idAgent.type}" />
                                                    </div>
                                                </h:panelGroup>     
                                            </div>
                                        </p:column>

                                        <p:column style=" width: 15%;">
                                            <h:outputText  value="#{nota.creationDate}" >
                                                <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
                                            </h:outputText>
                                        </p:column>

                                    </p:row> 
                                    <p:row>
                                        <p:column  colspan="2">
                                            <blockquote>
                                                <h:outputText escape="false"
                                                              value="#{nota.note}"/>
                                            </blockquote>
                                        </p:column>

                                    </p:row>
                                </p:panelGrid>
                            </p:dataList>
                            <p:commandLink value="Add nota"
                                           ajax="true"
                                           style="color:#0088CC;"
                                           actionListener="#{editQuoteController.showTextArea()}"
                                           update=":form:panelTextArea"
                                           process="@this"
                                           >
                            </p:commandLink>
                            <h:panelGrid width="100%" style="text-align: left; display: none;" id="panelTextArea">
                                <h:outputText value="#{maximusBundle.note_label}"  />
                                <p:inputTextarea value="#{editQuoteController.note}"   style="width:690px; margin-left: 10px;"/>
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:outputPanel>
                </p:panel>

                <p:commandButton value="#{maximusBundle.Cancel}" action="#{editQuoteController.getTypeAgent()}" id="buttonCancel" ajax="true" process="@this" />
                <p:commandButton value="#{maximusBundle.Save}" action="#{editQuoteController.editRequest()}" id="buttonEdit" ajax="false"/>
            </h:form>
            <h:form id="formDialiog">
                <p:dialog header="Basic Dialog"  widgetVar="dialogPart"  id="dialogPart" resizable="false" draggable="true"  maximizable="true" modal="true" position="center" width="100%" height="100%">

                    <p:panel  id="panelPrincipal">
                        <p:panel header="Search Part" id="panelSearch">
                            <p:messages autoUpdate="true"  />
                            <h:panelGrid columns="2" style="text-align: left"> 

                                <h:outputText value="#{maximusBundle.CreateHasTitle_hasPK_partNumber}" />
                                <p:inputText value="#{editQuoteController.nroPart}"  />

                                <h:outputText value="#{maximusBundle.CreateProductTitle_manufacture}" />
                                <p:inputText value="#{editQuoteController.manufacturePart}"  />

                                <h:outputText value="#{maximusBundle.CreateProductTitle_description}" />
                                <p:inputText value="#{editQuoteController.descriptionPart}" />


                                <h:outputText value="#{maximusBundle.CreateProductTitle_type}" />
                                <p:inputText value="#{editQuoteController.typePart}"  />


                            </h:panelGrid>

                        </p:panel>

                        <p:outputPanel style="text-align: left; width: 100%">
                            <p:commandButton value="#{maximusBundle.search}" actionListener="#{editQuoteController.searchPart()}" update="panelPrincipal" ajax="true" process="@this"/>

                            <p:commandButton value="Reset" actionListener="#{editQuoteController.reset()}" update="panelSearch" ajax="true" process="@this"/>

                        </p:outputPanel> 



                        <p:outputPanel  rendered="#{editQuoteController.partList != null}" id="panelTable" autoUpdate="true">
                            <p:separator/>
                            <p:dataTable id="datalistPart"
                                         value="#{editQuoteController.partList}"
                                         lazy="true"
                                         var="item"
                                         paginator="true"
                                         rows="10"
                                         rowsPerPageTemplate="10,20,30,40,50"
                                         emptyMessage="list Empty"
                                         paginatorPosition="bottom"
                                         selection="#{editQuoteController.selectedPart}"
                                         rowKey="#{item.partNumber}"
                                         scrollable="true"
                                         scrollHeight="300"
                                         >
                                <p:column selectionMode="multiple" style="width:10px;text-align:center"/>
                                <p:column  style="width :90px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateHasTitle_hasPK_partNumber}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.partNumber}"/>

                                </p:column>

                                <p:column  style="width : 90px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_manufacture}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.manufacture}"/>
                                </p:column>

                                <p:column style="width : 140px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_description}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.description}"/>
                                </p:column>

                                <p:column  style="width : 85px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_type}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.type}"/>
                                </p:column>

                                <p:column  style="width : 140px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_notes}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.notes}"/>
                                </p:column>

                                <p:column style="width : 85px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_retailPrice}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.retailPrice}">
                                        <f:convertNumber pattern="¤#,##0.00" currencySymbol="$" />
                                    </h:outputText>
                                </p:column>

                                <p:column style="width : 120px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_wholesalePrice}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.wholesalePrice}">  
                                        <f:convertNumber pattern="¤#,##0.00" currencySymbol="R$" />
                                    </h:outputText>
                                </p:column>

                                <p:column style="width : 80px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_price}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.price}">
                                        <f:convertNumber pattern="¤#,##0.00" currencySymbol="R$" />
                                    </h:outputText>
                                </p:column>

                            </p:dataTable>

                            <p:separator/>


                        </p:outputPanel>
                    </p:panel>
                    <p:outputPanel style="text-align: left; width: 100%">

                        <p:commandButton value="#{maximusBundle.Cancel}"  ajax="false" oncomplete="PF('dialogPart').hide()" update=":form:datalistProduct"/>
                        <p:commandButton value="#{maximusBundle.add}" id="buttonAdd" ajax="false"  actionListener="#{editQuoteController.addPart()}" oncomplete="PF('dialogPart').hide()" update=":form:datalistProduct"/>
                    </p:outputPanel> 
                </p:dialog>


            </h:form>

        </ui:define>

    </ui:composition>

</html>