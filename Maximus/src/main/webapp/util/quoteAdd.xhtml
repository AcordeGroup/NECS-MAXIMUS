<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/WEB-INF/include/admin/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{maximusBundle.AppName}"></h:outputText>
        </ui:define>
        <ui:define name="menu">
            <!-- Menu here. Also a layout and a way to log a user out -->
            <ui:include src="/sales/appmenu.xhtml"/>
        </ui:define>
        <ui:define name="body">
            <h:form id="form">
                <p:panel header="#{maximusBundle.new_request_label}" id="panelRequest">
                    <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true"/>
                    <h:panelGrid columns="2" style="text-align: left">
                        <h:outputText value="#{maximusBundle.CustomerHeading} *" />
                        <h:selectOneMenu id="customer" value="#{createQuoteController.customerSelected}" converter="customerConverter" style="width:255px;">
                            <f:selectItem itemLabel="#{maximusBundle.SelectOneMessage}"/>
                            <f:selectItems value="#{createQuoteController.customerList}"
                                           var="item"
                                           itemValue="#{item}"
                                           itemLabel="#{item.companyName.companyName}"
                                           />
                            <p:ajax update="panelRequest" /> 
                        </h:selectOneMenu>

                    </h:panelGrid>
                    <p:outputPanel   rendered="#{createQuoteController.customerSelected != null}">
                        <h:panelGrid columns="2" style="text-align: left">

                            <h:panelGrid columns="2" style="text-align: left">
                                <h:outputText value="#{maximusBundle.label_address}" />
                                <p:inputText value="#{createQuoteController.customerSelected.companyName.companyAddress}" disabled="true" style="margin-left: 15px; width: 250px;" />



                                <h:outputText value="#{maximusBundle.label_country}" />
                                <p:inputText value="#{createQuoteController.customerSelected.companyName.country}" disabled="true" style="margin-left: 15px; width: 250px;" />



                                <h:outputText value="#{maximusBundle.label_contact}" />
                                <p:inputText value="#{createQuoteController.customerSelected.primaryContact}" style="margin-left: 15px; width: 250px;"/>

                                <h:outputText value="#{maximusBundle.label_email}" />
                                <p:inputText value="#{createQuoteController.customerSelected.primaryEmail}" style="margin-left: 15px; width: 250px;" />

                            </h:panelGrid>
                            <h:panelGrid columns="2" style="text-align: left; vertical-align: top;" rendered="#{createQuoteController.customerSelected != null}">
                                <h:outputText value="#{maximusBundle.label_shipping_to}"  style="margin-left: 10px; vertical-align: top;" />
                                <p:inputTextarea value="#{createQuoteController.shippingTo}"  style="width:300px; margin-left: 10px; "/>
                                <h:outputText value="#{maximusBundle.label_include_shipping}"  style="margin-left: 10px;"  />
                                <h:selectOneMenu id="cost" value="#{createQuoteController.includeShipping}"  style="width:308px; margin-left: 10px;">
                                    <f:selectItem itemLabel="#{maximusBundle.No}" itemValue="No"/>
                                    <f:selectItem itemLabel="#{maximusBundle.Yes_price_item}" itemValue="#{maximusBundle.Yes_price_item}"/>
                                    <f:selectItem itemLabel="#{maximusBundle.Yes_separate}" itemValue="#{maximusBundle.Yes_separate}"/>
                                    <p:ajax update="datalistProduct" /> 
                                </h:selectOneMenu>

                            </h:panelGrid>
                        </h:panelGrid>
                        <p:spacer />
                        <p:separator />
                        <p:outputPanel style="text-align: right; width: 100% ">
                            <p:commandButton  type="button" id="buttonAddPart" value="#{maximusBundle.add_part_button}" onclick="PF('dialogPart').show()" ajax="true" oncomplete="#{createQuoteController.reset()}" update=":formDialog"/>

                        </p:outputPanel>
                        <p:spacer />
                        <p:outputPanel autoUpdate="true">
                            <p:dataTable id="datalistProduct"
                                         value="#{createQuoteController.partListHas}"
                                         var="item"
                                         emptyMessage="list Empty"
                                         rendered="#{createQuoteController.partListHas != null}"
                                         >

                                <p:column  style="width : 110px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductCostTitle_partNumber}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.product.partNumber}"/>
                                </p:column>

                                <p:column  style="width : 170px" >
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_description}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.product.description}" rendered="#{item.product.partNumber != '555555'}"/>
                                    <h:outputText value="#{createQuoteController.observation}" rendered="#{item.product.partNumber == '555555'}"/>
                                </p:column>

                                <p:column style="width : 95px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.condition_label}"/>
                                    </f:facet>
                                    <p:selectOneButton value="#{item.condition}" required="true" requiredMessage="#{maximusBundle.message_condition_select}" style="width: 120px; height: 25px">
                                        <f:selectItem itemLabel="#{maximusBundle.ref}" itemValue="#{maximusBundle.ref}"  />
                                        <f:selectItem itemLabel="#{maximusBundle.new}" itemValue="#{maximusBundle.new}" />
                                    </p:selectOneButton>
                                </p:column>

                                <p:column  style="width : 60px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.qty_label}"/>
                                    </f:facet>
                                    <p:spinner id="basic" value="#{item.qtyRequested}" size="3"  min="0" required="true"  requiredMessage="#{maximusBundle.message_qty_product}"  >
                                        <p:ajax update=":form:datalistProduct:extended" listener="#{createQuoteController.addExtended(item)}" />
                                    </p:spinner>
                                </p:column>

                                <p:column  style="width : 75px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.target_price_label}"/>
                                    </f:facet>
                                    <p:inputText converter="javax.faces.Double" converterMessage="#{maximusBundlemessage_only_numbers}"  value="#{item.product.price}"  size="10">
                                        <p:ajax update=":form:datalistProduct:extended" listener="#{createQuoteController.addExtended(item)}" />
                                    </p:inputText>

                                </p:column>

                                <p:column style="width : 75px">
                                    <f:facet name="header">
                                        <h:outputText value="Extended"/>
                                    </f:facet>
                                    <p:inputText id="extended" converter="javax.faces.Double" converterMessage="#{maximusBundlemessage_only_numbers}" value="#{item.extended}"  size="10"/>
                                </p:column>
                                <p:column style="width : 80px">
                                    <f:facet name="header">
                                        <h:outputText value="action"/>
                                    </f:facet>
                                    <p:commandLink id="buttonRemovePart" value="#{maximusBundle.remove_button}" actionListener="#{createQuoteController.removePart(item)}" ajax="true" update=":form:datalistProduct" process="@this" />

                                </p:column>
                            </p:dataTable>
                        </p:outputPanel>
                        <p:spacer />
                        <p:separator />
                        <p:spacer />
                        <h:panelGrid width="100%" style="text-align: left;">
                            <h:outputText value="#{maximusBundle.note_label}"  />
                            <p:inputTextarea value="#{createQuoteController.note}"   style="width:690px; margin-left: 10px;"/>
                        </h:panelGrid>
                    </p:outputPanel>
                </p:panel>

                <p:commandButton value="#{maximusBundle.Cancel}" action="#{createQuoteController.typeAgent()}" id="buttonCancel" ajax="true" process="@this"/>
                <p:commandButton value="#{maximusBundle.Save}" action="#{createQuoteController.createNewRequest()}" id="buttonSave" ajax="false"/>
            </h:form>

            <p:dialog header="Basic Dialog"  widgetVar="dialogPart"  id="dialogPart" resizable="false" draggable="true"  maximizable="true" modal="true" position="center" width="100%" height="100%">
                <h:form id="formDialog">
                    <p:panel  id="panelPrincipal">
                        <p:messages id="messagesDialog" showDetail="true" autoUpdate="true" closable="true"/>

                        <p:panel header="Search Part" id="panelSearch">
                            <h:panelGrid columns="2" width="100%"> 
                                <h:panelGrid columns="2" style="text-align: left" id="panelSearchInterno"> 

                                    <h:outputText value="#{maximusBundle.CreateHasTitle_hasPK_partNumber}" />
                                    <p:autoComplete id="acSimple" value="#{createQuoteController.nroPart}" 
                                                    completeMethod="#{createQuoteController.complete}"
                                                    var="part" 
                                                    converter="productConverter"
                                                    itemLabel="#{part.partNumber}"
                                                    itemValue="#{part}"
                                                    maxResults="10"/>
                                    <h:outputText value="#{maximusBundle.CreateProductTitle_manufacture}" />
                                    <p:inputText value="#{createQuoteController.manufacturePart}"  />

                                    <h:outputText value="#{maximusBundle.CreateProductTitle_description}" />
                                    <p:inputText value="#{createQuoteController.descriptionPart}" />


                                    <h:outputText value="#{maximusBundle.CreateProductTitle_type}" />
                                    <p:inputText value="#{createQuoteController.typePart}"  />


                                </h:panelGrid>
                                <p:outputPanel autoUpdate="true"  style="text-align: left; margin-left: 50px; vertical-align: middle;" rendered="#{createQuoteController.observationField}" > 
                                    <h:panelGrid columns="2" style="text-align: left; vertical-align: top;">
                                        <h:outputText value="#{maximusBundle.label_observations}" style="margin-right: 10px;" />
                                        <p:inputTextarea value="#{createQuoteController.observation}"  style="width: 500px;"/>
                                    </h:panelGrid> 
                                </p:outputPanel>
                            </h:panelGrid>

                        </p:panel>

                        <p:outputPanel style="text-align: left; width: 100%">
                            <p:commandButton value="#{maximusBundle.search}" actionListener="#{createQuoteController.searchPart()}" update=":formDialog:panelPrincipal" oncomplete="PF('dialogPart').initPosition()" />

                            <p:commandButton value="Reset" ajax="true" action="#{createQuoteController.reset()}" update=":formDialog:panelPrincipal" oncomplete="PF('dialogPart').initPosition()"/>

                        </p:outputPanel> 

                        <p:spacer />

                        <p:outputPanel  rendered="#{createQuoteController.partList != null}" id="panelTable" autoUpdate="true">
                            <p:separator/>
                            <p:dataTable id="datalistPart"
                                         value="#{createQuoteController.partList}"
                                         var="item"
                                         paginator="true"
                                         rows="10"
                                         rowsPerPageTemplate="10,20,30,40,50"
                                         emptyMessage="#{maximusBundle.no_search_result}"
                                         paginatorPosition="bottom"
                                         selection="#{createQuoteController.selectedPart}"
                                         rowKey="#{item.partNumber}"
                                         scrollable="true"
                                         scrollHeight="300"
                                         >
                                <p:column selectionMode="multiple" style="width:10px;text-align:center" />
                                <p:column  style="width :90px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateHasTitle_hasPK_partNumber}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.partNumber}"/>

                                </p:column>

                                <p:column  style="width : 90px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_manufacture}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.manufacture}"/>
                                </p:column>

                                <p:column style="width : 140px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_description}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.description}"/>
                                </p:column>

                                <p:column  style="width : 85px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_type}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.type}"/>
                                </p:column>

                                <p:column  style="width : 140px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_notes}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.notes}"/>
                                </p:column>

                                <p:column style="width : 85px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_retailPrice}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.retailPrice}">
                                        <f:convertNumber pattern="¤#,##0.00" currencySymbol="$" />
                                    </h:outputText>
                                </p:column>

                                <p:column style="width : 120px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_wholesalePrice}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.wholesalePrice}">  
                                        <f:convertNumber pattern="¤#,##0.00" currencySymbol="$" type="currency"/>
                                    </h:outputText>
                                </p:column>

                                <p:column style="width : 80px">
                                    <f:facet name="header">
                                        <h:outputText value="#{maximusBundle.CreateProductTitle_price}"/>
                                    </f:facet>
                                    <h:outputText value="#{item.price}">
                                        <f:convertNumber pattern="¤#,##0.00" currencySymbol="$" type="currency"/>
                                    </h:outputText>
                                </p:column>

                            </p:dataTable>

                            <p:separator/>


                        </p:outputPanel>
                    </p:panel>
                    <p:outputPanel style="text-align: left; width: 100%">

                        <p:commandButton value="#{maximusBundle.Cancel}"  ajax="false" oncomplete="PF('dialogPart').hide()" update=":form:datalistProduct" actionListener="#{createQuoteController.reset()}"/>
                        <p:commandButton value="#{maximusBundle.add}" id="buttonAdd" ajax="true" action="#{createQuoteController.addPart()}"  update=":form:datalistProduct" oncomplete="PF('dialogPart').initPosition()" />
                    </p:outputPanel> 
                </h:form>
            </p:dialog>

        </ui:define>

    </ui:composition>

</html>
